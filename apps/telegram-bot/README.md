# Telegram Bot

Telegram –±–æ—Ç –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã—Ö —Ä—ã–Ω–∫–æ–≤ –Ω–∞ –±–∞–∑–µ Grammy.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ö–æ–º–∞–Ω–¥—ã: `/start`, `/markets`, `/balance`, `/help`
- ‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `/start ref_XXXXX`
- ‚úÖ Deep links –∫ Mini App
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Ä—ã–Ω–∫–∞—Ö
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ —Ä—ã–Ω–∫–æ–≤
- ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—ã–∏–≥—Ä—ã—à–∞—Ö –∏ –ø—Ä–æ–∏–≥—Ä—ã—à–∞—Ö
- ‚úÖ –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
npm install
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```bash
cp .env.example .env
```

2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
API_URL=http://localhost:3000/api
MINI_APP_URL=https://your-mini-app.com
```

## –ó–∞–ø—É—Å–∫

### Development (Polling)
```bash
npm run dev
```

### Production (Webhook)
```bash
npm run build
npm run start
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `WEBHOOK_URL` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `.env`.

## –ö–æ–º–∞–Ω–¥—ã

### /start
–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –±–æ—Ç–∞. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏:
```
/start ref_ABC123
```

### /markets
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä—ã–Ω–∫–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–±—ä–µ–º–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Å—Ç–∞–≤–æ–∫.

### /balance
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ—Å—Ç—É–ø–Ω–æ, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ, –≤—Å–µ–≥–æ).

### /help
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º.

## –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ `/start ref_XXXXX`
- –ë–æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥
- –†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ

## –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ:
- üÜï –ù–æ–≤—ã—Ö —Ä—ã–Ω–∫–∞—Ö
- ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–∏ —Ä—ã–Ω–∫–æ–≤
- üéâ –í—ã–∏–≥—Ä—ã—à–∞—Ö —Å—Ç–∞–≤–æ–∫
- üòî –ü—Ä–æ–∏–≥—Ä—ã—à–∞—Ö —Å—Ç–∞–≤–æ–∫

–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `NotificationService`.

## Deep Links

–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–Ω–æ–ø–∫—É "–û—Ç–∫—Ä—ã—Ç—å Mini App" —Å deep link:
- `/markets` - —Å–ø–∏—Å–æ–∫ —Ä—ã–Ω–∫–æ–≤
- `/markets/:id` - –¥–µ—Ç–∞–ª–∏ —Ä—ã–Ω–∫–∞
- `/wallet` - –∫–æ—à–µ–ª–µ–∫

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API –∫–ª–∏–µ–Ω—Ç –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å backend:
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–∫–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ commands/          # –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ start.command.ts
‚îÇ   ‚îú‚îÄ‚îÄ markets.command.ts
‚îÇ   ‚îî‚îÄ‚îÄ balance.command.ts
‚îú‚îÄ‚îÄ services/          # –°–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ api.ts        # API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ notifications.ts  # –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ middleware/        # Middleware
‚îÇ   ‚îî‚îÄ‚îÄ referral.middleware.ts
‚îú‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ messages.ts   # –¢–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ webhooks/         # Webhook handlers
‚îÇ   ‚îî‚îÄ‚îÄ notifications.webhook.ts
‚îî‚îÄ‚îÄ index.ts          # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤–æ–º —Ä—ã–Ω–∫–µ

```typescript
import { notificationService } from './index';

await notificationService.notifyNewMarket(market, ['user_id_1', 'user_id_2']);
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤—ã–∏–≥—Ä—ã—à–µ

```typescript
await notificationService.notifyBetWon(bet, '95.50', 'user_id');
```

## –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

–í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `src/utils/messages.ts`.
