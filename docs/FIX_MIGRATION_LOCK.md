# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –º–∏–≥—Ä–∞—Ü–∏–π Prisma

## –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞: `Timed out trying to acquire a postgres advisory lock`

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Prisma –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏.

## –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≤–∏—Å—à–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

1. –û—Ç–∫—Ä–æ–π—Ç–µ **pgAdmin 4**
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É PostgreSQL
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∑–∞–ø—Ä–æ—Å:
   ```sql
   SELECT pid, usename, application_name, state, query 
   FROM pg_stat_activity 
   WHERE datname = 'polymarket';
   ```
4. –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –∑–∞–≤–∏—Å—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –∑–∞–≤–µ—Ä—à–∏—Ç–µ –∏—Ö:
   ```sql
   SELECT pg_terminate_backend(pid) 
   FROM pg_stat_activity 
   WHERE datname = 'polymarket' AND state = 'idle';
   ```

### –†–µ—à–µ–Ω–∏–µ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL

1. –û—Ç–∫—Ä–æ–π—Ç–µ **–°–ª—É–∂–±—ã Windows** (Win + R ‚Üí `services.msc`)
2. –ù–∞–π–¥–∏—Ç–µ —Å–ª—É–∂–±—É **postgresql-x64-14** (–∏–ª–∏ –ø–æ—Ö–æ–∂—É—é)
3. –ü—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π ‚Üí **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å**

### –†–µ—à–µ–Ω–∏–µ 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `db push` –≤–º–µ—Å—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–π

–ï—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `db push`:

```bash
cd apps/backend
npx prisma db push
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Å—Ö–µ–º—É –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π.

### –†–µ—à–µ–Ω–∏–µ 4: –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É `prisma/migrations` –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É `prisma/migrations/0_init`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `prisma migrate dev --create-only` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è SQL —Ñ–∞–π–ª–∞
4. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ SQL –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ pgAdmin

### –†–µ—à–µ–Ω–∏–µ 5: –°–±—Ä–æ—Å–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–û–°–¢–û–†–û–ñ–ù–û!)

**‚ö†Ô∏è –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ!**

```bash
cd apps/backend
npx prisma migrate reset
```

–ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –∑–∞–Ω–æ–≤–æ:
```bash
npx prisma migrate dev --name init
```

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π

1. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –†–µ—à–µ–Ω–∏–µ 2** (–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL)
2. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –†–µ—à–µ–Ω–∏–µ 3** (`db push`) - —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
3. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - **–†–µ—à–µ–Ω–∏–µ 1** (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
4. –í –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ - **–†–µ—à–µ–Ω–∏–µ 5** (—Å–±—Ä–æ—Å)

---

## –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã

```bash
cd apps/backend
npm run prisma:seed
```

–≠—Ç–æ –∑–∞–ø–æ–ª–Ω–∏—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

